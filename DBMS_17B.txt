CREATE DATABASE A;
USE A;

CREATE TABLE O_ROLLCALL(ROLL_NO INT,NAME VARCHAR(255), PRIMARY KEY(ROLL_NO));
CREATE TABLE N_ROLLCALL(ROLL_NO INT,NAME VARCHAR(255), PRIMARY KEY(ROLL_NO));

INSERT INTO O_ROLLCALL VALUES(36,'APOORVA');
INSERT INTO O_ROLLCALL VALUES(26,'PRATIKSHA');
INSERT INTO O_ROLLCALL VALUES(16,'GITA');
INSERT INTO O_ROLLCALL VALUES(6,'SHWETA');
INSERT INTO N_ROLLCALL VALUES(6,'SHWETA');
INSERT INTO N_ROLLCALL VALUES(53,'POOJA');
INSERT INTO N_ROLLCALL VALUES(16,'GITA');
INSERT INTO N_ROLLCALL VALUES(11,'SITA');

DELIMITER $
CREATE PROCEDURE ROLL_LIST()
BEGIN
DECLARE O_ROLLNO INT;
DECLARE O_NAME VARCHAR(10);
DECLARE N_ROLLNO INT;
DECLARE N_NAME VARCHAR(10);
DECLARE DONE INT DEFAULT FALSE;
DECLARE C1 CURSOR FOR SELECT ROLL_NO,NAME FROM O_ROLLCALL;
DECLARE C2 CURSOR FOR SELECT ROLL_NO,NAME FROM N_ROLLCALL;
DECLARE CONTINUE HANDLER FOR NOT FOUND SET DONE=TRUE;
OPEN C1;
OPEN C2;
LOOP1:LOOP
FETCH C1 INTO O_ROLLNO,O_NAME;
IF DONE THEN
LEAVE LOOP1;
END IF;
LOOP2:LOOP
FETCH C2 INTO N_ROLLNO,N_NAME;
IF DONE THEN
INSERT INTO N_ROLLCALL VALUES(O_ROLLNO,O_NAME);
SET DONE=FALSE;

LEAVE LOOP2;
END IF;
IF O_ROLLNO=N_ROLLNO THEN
LEAVE LOOP2;
END IF;
END LOOP;
END LOOP;
CLOSE C2;
CLOSE C1;
END $

DELIMITER ;


SELECT *FROM O_ROLLCALL;

SELECT *FROM N_ROLLCALL;

CALL ROLL_LIST;

SELECT *FROM N_ROLLCALL;
