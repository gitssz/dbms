CREATE DATABASE DBMS_17A;
USE DBMS_17A;

CREATE TABLE BANK_MANAGER(ID INT NOT NULL PRIMARY KEY,INACTIVE_DAYS INT,STATUS VARCHAR(20));

INSERT INTO BANK_MANAGER VALUES (01,256,"ACTIVE");
INSERT INTO BANK_MANAGER VALUES (02,456,"INACTIVE");
INSERT INTO BANK_MANAGER VALUES (03,545,"INACTIVE");
INSERT INTO BANK_MANAGER VALUES (04,222,"ACTIVE");
INSERT INTO BANK_MANAGER VALUES (05,120,"ACTIVE");
INSERT INTO BANK_MANAGER VALUES (06,30,"ACTIVE");

SELECT * FROM BANK_MANAGER;

DELIMITER $
CREATE PROCEDURE BANK()
BEGIN
DECLARE DONE INT DEFAULT FALSE;
DECLARE STAT VARCHAR(20);
DECLARE C1 CURSOR FOR SELECT STATUS FROM BANK_MANAGER;
DECLARE CONTINUE HANDLER FOR NOT FOUND SET DONE = TRUE;
OPEN C1;
READ_LOOP: LOOP
FETCH C1 INTO STAT;
IF DONE THEN
LEAVE READ_LOOP;
END IF;
UPDATE BANK_MANAGER SET STATUS='ACTIVE'WHERE STATUS='INACTIVE';
END LOOP;
CLOSE C1;
END$

DELIMITER ;

CALL BANK();
SELECT * FROM BANK_MANAGER;
